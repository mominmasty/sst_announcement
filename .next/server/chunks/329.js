"use strict";exports.id=329,exports.ids=[329],exports.modules={7329:(e,t,n)=>{n.d(t,{sendAnnouncementEmail:()=>N});var r=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,l=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&l(e,n,t[n]);if(o)for(var n of o(t))d.call(t,n)&&l(e,n,t[n]);return e},u=(e,t)=>i(e,s(t)),h=(e,t,n)=>new Promise((r,i)=>{var s=e=>{try{a(n.next(e))}catch(e){i(e)}},o=e=>{try{a(n.throw(e))}catch(e){i(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())}),p=class{constructor(e){this.resend=e}create(e){return h(this,arguments,function*(e,t={}){return yield this.resend.post("/api-keys",e,t)})}list(){return h(this,null,function*(){return yield this.resend.get("/api-keys")})}remove(e){return h(this,null,function*(){return yield this.resend.delete(`/api-keys/${e}`)})}},m=class{constructor(e){this.resend=e}create(e){return h(this,arguments,function*(e,t={}){return yield this.resend.post("/audiences",e,t)})}list(){return h(this,null,function*(){return yield this.resend.get("/audiences")})}get(e){return h(this,null,function*(){return yield this.resend.get(`/audiences/${e}`)})}remove(e){return h(this,null,function*(){return yield this.resend.delete(`/audiences/${e}`)})}};function f(e){var t;return{attachments:null==(t=e.attachments)?void 0:t.map(e=>({content:e.content,filename:e.filename,path:e.path,content_type:e.contentType,inline_content_id:e.inlineContentId})),bcc:e.bcc,cc:e.cc,from:e.from,headers:e.headers,html:e.html,reply_to:e.replyTo,scheduled_at:e.scheduledAt,subject:e.subject,tags:e.tags,text:e.text,to:e.to}}var y=class{constructor(e){this.resend=e}send(e){return h(this,arguments,function*(e,t={}){return this.create(e,t)})}create(e){return h(this,arguments,function*(e,t={}){let r=[];for(let t of e){if(t.react){if(!this.renderAsync)try{let{renderAsync:e}=yield n.e(891).then(n.bind(n,5891));this.renderAsync=e}catch(e){throw Error("Failed to render React component. Make sure to install `@react-email/render`")}t.html=yield this.renderAsync(t.react),t.react=void 0}r.push(f(t))}return yield this.resend.post("/emails/batch",r,t)})}},g=class{constructor(e){this.resend=e}create(e){return h(this,arguments,function*(e,t={}){if(e.react){if(!this.renderAsync)try{let{renderAsync:e}=yield n.e(891).then(n.bind(n,5891));this.renderAsync=e}catch(e){throw Error("Failed to render React component. Make sure to install `@react-email/render`")}e.html=yield this.renderAsync(e.react)}return yield this.resend.post("/broadcasts",{name:e.name,audience_id:e.audienceId,preview_text:e.previewText,from:e.from,html:e.html,reply_to:e.replyTo,subject:e.subject,text:e.text},t)})}send(e,t){return h(this,null,function*(){return yield this.resend.post(`/broadcasts/${e}/send`,{scheduled_at:null==t?void 0:t.scheduledAt})})}list(){return h(this,null,function*(){return yield this.resend.get("/broadcasts")})}get(e){return h(this,null,function*(){return yield this.resend.get(`/broadcasts/${e}`)})}remove(e){return h(this,null,function*(){return yield this.resend.delete(`/broadcasts/${e}`)})}update(e,t){return h(this,null,function*(){return yield this.resend.patch(`/broadcasts/${e}`,{name:t.name,audience_id:t.audienceId,from:t.from,html:t.html,text:t.text,subject:t.subject,reply_to:t.replyTo,preview_text:t.previewText})})}},b=class{constructor(e){this.resend=e}create(e){return h(this,arguments,function*(e,t={}){return yield this.resend.post(`/audiences/${e.audienceId}/contacts`,{unsubscribed:e.unsubscribed,email:e.email,first_name:e.firstName,last_name:e.lastName},t)})}list(e){return h(this,null,function*(){return yield this.resend.get(`/audiences/${e.audienceId}/contacts`)})}get(e){return h(this,null,function*(){return e.id||e.email?yield this.resend.get(`/audiences/${e.audienceId}/contacts/${(null==e?void 0:e.email)?null==e?void 0:e.email:null==e?void 0:e.id}`):{data:null,error:{message:"Missing `id` or `email` field.",name:"missing_required_field"}}})}update(e){return h(this,null,function*(){return e.id||e.email?yield this.resend.patch(`/audiences/${e.audienceId}/contacts/${(null==e?void 0:e.email)?null==e?void 0:e.email:null==e?void 0:e.id}`,{unsubscribed:e.unsubscribed,first_name:e.firstName,last_name:e.lastName}):{data:null,error:{message:"Missing `id` or `email` field.",name:"missing_required_field"}}})}remove(e){return h(this,null,function*(){return e.id||e.email?yield this.resend.delete(`/audiences/${e.audienceId}/contacts/${(null==e?void 0:e.email)?null==e?void 0:e.email:null==e?void 0:e.id}`):{data:null,error:{message:"Missing `id` or `email` field.",name:"missing_required_field"}}})}},x=class{constructor(e){this.resend=e}create(e){return h(this,arguments,function*(e,t={}){return yield this.resend.post("/domains",{name:e.name,region:e.region,custom_return_path:e.customReturnPath},t)})}list(){return h(this,null,function*(){return yield this.resend.get("/domains")})}get(e){return h(this,null,function*(){return yield this.resend.get(`/domains/${e}`)})}update(e){return h(this,null,function*(){return yield this.resend.patch(`/domains/${e.id}`,{click_tracking:e.clickTracking,open_tracking:e.openTracking,tls:e.tls})})}remove(e){return h(this,null,function*(){return yield this.resend.delete(`/domains/${e}`)})}verify(e){return h(this,null,function*(){return yield this.resend.post(`/domains/${e}/verify`)})}},v=class{constructor(e){this.resend=e}send(e){return h(this,arguments,function*(e,t={}){return this.create(e,t)})}create(e){return h(this,arguments,function*(e,t={}){if(e.react){if(!this.renderAsync)try{let{renderAsync:e}=yield n.e(891).then(n.bind(n,5891));this.renderAsync=e}catch(e){throw Error("Failed to render React component. Make sure to install `@react-email/render`")}e.html=yield this.renderAsync(e.react)}return yield this.resend.post("/emails",f(e),t)})}get(e){return h(this,null,function*(){return yield this.resend.get(`/emails/${e}`)})}update(e){return h(this,null,function*(){return yield this.resend.patch(`/emails/${e.id}`,{scheduled_at:e.scheduledAt})})}cancel(e){return h(this,null,function*(){return yield this.resend.post(`/emails/${e}/cancel`)})}},w="undefined"!=typeof process&&process.env&&process.env.RESEND_BASE_URL||"https://api.resend.com",_="undefined"!=typeof process&&process.env&&process.env.RESEND_USER_AGENT||"resend-node:4.8.0",$=class{constructor(e){if(this.key=e,this.apiKeys=new p(this),this.audiences=new m(this),this.batch=new y(this),this.broadcasts=new g(this),this.contacts=new b(this),this.domains=new x(this),this.emails=new v(this),!e&&("undefined"!=typeof process&&process.env&&(this.key="re_2Kn711pT_CjTUiSrn7JXCoqV9hgXECpKc"),!this.key))throw Error('Missing API key. Pass it to the constructor `new Resend("re_123")`');this.headers=new Headers({Authorization:`Bearer ${this.key}`,"User-Agent":_,"Content-Type":"application/json"})}fetchRequest(e){return h(this,arguments,function*(e,t={}){try{let n=yield fetch(`${w}${e}`,t);if(!n.ok)try{let e=yield n.text();return{data:null,error:JSON.parse(e)}}catch(t){if(t instanceof SyntaxError)return{data:null,error:{name:"application_error",message:"Internal server error. We are unable to process your request right now, please try again later."}};let e={message:n.statusText,name:"application_error"};if(t instanceof Error)return{data:null,error:u(c({},e),{message:t.message})};return{data:null,error:e}}return{data:yield n.json(),error:null}}catch(e){return{data:null,error:{name:"application_error",message:"Unable to fetch data. The request could not be resolved."}}}})}post(e,t){return h(this,arguments,function*(e,t,n={}){let r=new Headers(this.headers);n.idempotencyKey&&r.set("Idempotency-Key",n.idempotencyKey);let i=c({method:"POST",headers:r,body:JSON.stringify(t)},n);return this.fetchRequest(e,i)})}get(e){return h(this,arguments,function*(e,t={}){let n=c({method:"GET",headers:this.headers},t);return this.fetchRequest(e,n)})}put(e,t){return h(this,arguments,function*(e,t,n={}){let r=c({method:"PUT",headers:this.headers,body:JSON.stringify(t)},n);return this.fetchRequest(e,r)})}patch(e,t){return h(this,arguments,function*(e,t,n={}){let r=c({method:"PATCH",headers:this.headers,body:JSON.stringify(t)},n);return this.fetchRequest(e,r)})}delete(e,t){return h(this,null,function*(){let n={method:"DELETE",headers:this.headers,body:JSON.stringify(t)};return this.fetchRequest(e,n)})}},E=n(3945);let A={local:{frontendUrl:"http://localhost:3000",backendUrl:"http://localhost:8787"},production:{frontendUrl:"https://sst-announcement.vercel.app",backendUrl:"https://sst-announcement.vercel.app"}},k=(0,E.Un)(),S=k.RESEND_API_KEY?new $(k.RESEND_API_KEY):null;async function N({title:e,description:t,category:n,recipientEmails:r,expiryDate:i,scheduledAt:s}){try{if(!S)return console.warn("Resend API key is not configured - email functionality disabled"),{success:!1,error:"Email service is not configured. Please set RESEND_API_KEY."};let o=function(){let e=(0,E.SL)(),t="production"===e.DEPLOYMENT?"production":"local",n=A[t],r={deployment:t,frontendUrl:e.FRONTEND_URL||n.frontendUrl,backendUrl:e.BACKEND_URL||n.backendUrl};return console.log("\uD83D\uDCCB Config loaded:",r),r}(),a=k.RESEND_FROM_EMAIL||"onboarding@resend.dev";if(0===r.length)return{success:!1,error:"No recipients specified"};let d=e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not specified",l=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="utf-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0" />
          <title>New Announcement: ${e}</title>
        </head>
        <body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
            <h1 style="color: white; margin: 0; font-size: 24px;">ðŸ“¢ New Announcement</h1>
          </div>
          <div style="background: #f9f9f9; padding: 30px; border: 1px solid #e0e0e0; border-top: none; border-radius: 0 0 10px 10px;">
            <h2 style="color: #667eea; margin-top: 0; font-size: 22px;">${e}</h2>
            <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <p style="margin: 0 0 15px 0; color: #555; font-size: 16px; white-space: pre-wrap;">${t}</p>
            </div>
            <div style="background: white; padding: 15px; border-radius: 8px; margin: 20px 0;">
              <table style="width: 100%; border-collapse: collapse;">
                <tr>
                  <td style="padding: 8px 0; font-weight: bold; color: #667eea;">Category:</td>
                  <td style="padding: 8px 0; color: #555; text-transform: capitalize;">${n}</td>
                </tr>
                ${i?`
                <tr>
                  <td style="padding: 8px 0; font-weight: bold; color: #667eea;">Expiry Date:</td>
                  <td style="padding: 8px 0; color: #555;">${d(i)}</td>
                </tr>
                `:""}
                ${s?`
                <tr>
                  <td style="padding: 8px 0; font-weight: bold; color: #667eea;">Scheduled For:</td>
                  <td style="padding: 8px 0; color: #555;">${d(s)}</td>
                </tr>
                `:""}
              </table>
            </div>
            <div style="text-align: center; margin-top: 30px;">
              <a href="${o.frontendUrl}" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold;">View All Announcements</a>
            </div>
          </div>
          <div style="text-align: center; margin-top: 20px; color: #999; font-size: 12px;">
            <p>This is an automated notification from the SST Announcement System.</p>
          </div>
        </body>
      </html>
    `,c=`
New Announcement: ${e}

${t}

Category: ${n}
${i?`Expiry Date: ${d(i)}`:""}
${s?`Scheduled For: ${d(s)}`:""}

View all announcements: ${o.frontendUrl}

This is an automated notification from the SST Announcement System.
    `.trim(),{error:u}=await S.emails.send({from:a,to:r,subject:`ðŸ“¢ New Announcement: ${e}`,html:l,text:c});if(u)return console.error("Error sending email via Resend:",u),{success:!1,error:u.message||"Failed to send email"};return{success:!0,message:`Email sent successfully to ${r.length} recipient(s)`}}catch(e){return console.error("Unexpected error sending email:",e),{success:!1,error:e instanceof Error?e.message:"Failed to send email"}}}}};