"use strict";(()=>{var e={};e.id=950,e.ids=[950],e.modules={846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1737:e=>{e.exports=import("drizzle-orm")},1214:e=>{e.exports=import("drizzle-orm/node-postgres")},8025:e=>{e.exports=import("drizzle-orm/pg-core")},4939:e=>{e.exports=import("pg")},7598:e=>{e.exports=require("node:crypto")},6025:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{patchFetch:()=>p,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>c});var s=t(2706),o=t(8203),a=t(5994),i=t(3802),u=e([i]);i=(u.then?(await u)():u)[0];let d=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/admin/users/route",pathname:"/api/admin/users",filename:"route",bundlePath:"app/api/admin/users/route"},resolvedPagePath:"E:\\Project\\sst_announcement\\app\\api\\admin\\users\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:l,workUnitAsyncStorage:c,serverHooks:m}=d;function p(){return(0,a.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:c})}n()}catch(e){n(e)}})},3802:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{GET:()=>d,OPTIONS:()=>l});var s=t(9187),o=t(517),a=t(4272),i=t(366),u=t(4172),p=e([a,u]);async function d(e){try{await (0,o.ay)(e,o.uZ);let r=await (0,a.oC)(e,{enforceDomain:!0});(0,i.eU)(r),(0,a.ZT)(r);let t=(await (0,u.CF)()).map(e=>({...e,role:e.role||"student",role_display:"super_admin"===e.role?"Super Admin":"admin"===e.role?"Admin":"student_admin"===e.role?"Student Admin":"Student"})),{searchParams:n}=new URL(e.url),p=n.get("email");if(p){let e=t.filter(e=>e.email&&e.email.toLowerCase().includes(p.toLowerCase()));return s.NextResponse.json({success:!0,data:e})}return s.NextResponse.json({success:!0,data:t})}catch(e){return s.NextResponse.json({success:!1,error:e.message||"Internal server error"},{status:e.status||500})}}async function l(){return new s.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}[a,u]=p.then?(await p)():p,n()}catch(e){n(e)}})},517:(e,r,t)=>{t.d(r,{Nw:()=>a,ay:()=>o,uZ:()=>i});var n=t(4218);let s=new Map;async function o(e,r){let t=function(e){let r=e.headers.get("x-forwarded-for");return r?r.split(",")[0]?.trim()||"unknown":e.headers.get("x-real-ip")||e.ip||"unknown"}(e),o=`${r.keyPrefix}:${t}`,a=Date.now(),i=s.get(o);if(!i||i.expiresAt<a){s.set(o,{count:1,expiresAt:a+r.windowMs});return}if(i.count>=r.max)throw new n.qQ("Too many requests, please try again later.");i.count+=1,s.set(o,i)}let a={windowMs:9e5,max:100,keyPrefix:"general"},i={windowMs:9e5,max:200,keyPrefix:"admin"}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[680,38,883,684],()=>t(6025));module.exports=n})();