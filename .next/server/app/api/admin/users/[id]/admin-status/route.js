"use strict";(()=>{var e={};e.id=83,e.ids=[83],e.modules={846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1737:e=>{e.exports=import("drizzle-orm")},1214:e=>{e.exports=import("drizzle-orm/node-postgres")},8025:e=>{e.exports=import("drizzle-orm/pg-core")},4939:e=>{e.exports=import("pg")},7598:e=>{e.exports=require("node:crypto")},6947:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>d,routeModule:()=>p,serverHooks:()=>l,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var n=r(2706),a=r(8203),o=r(5994),i=r(2901),u=e([i]);i=(u.then?(await u)():u)[0];let p=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/users/[id]/admin-status/route",pathname:"/api/admin/users/[id]/admin-status",filename:"route",bundlePath:"app/api/admin/users/[id]/admin-status/route"},resolvedPagePath:"E:\\Project\\sst_announcement\\app\\api\\admin\\users\\[id]\\admin-status\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:l}=p;function d(){return(0,o.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}s()}catch(e){s(e)}})},2901:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{OPTIONS:()=>m,PATCH:()=>c});var n=r(9187),a=r(517),o=r(4272),i=r(366),u=r(4172),d=r(4218),p=e([o,u]);async function c(e,{params:t}){try{await (0,a.ay)(e,a.uZ);let r=await (0,o.oC)(e,{enforceDomain:!0});(0,i.eU)(r),(0,o.Kv)(r);let{id:s}=await t,p=function(e){if(!e)throw new d.v7("User ID is required");let t=Number(e);if(Number.isNaN(t))throw new d.v7("User ID must be a valid number");return t}(s),c=await e.json();if("boolean"!=typeof c.is_admin)throw new d.v7("is_admin is required and must be a boolean");if(!await (0,u.kl)(p))throw new d.m_("User",p);let m=await (0,u.cz)(p,c.is_admin);return n.NextResponse.json({success:!0,data:m,message:`User admin status updated to ${c.is_admin?"admin":"student"}`})}catch(e){return n.NextResponse.json({success:!1,error:e.message||"Internal server error"},{status:e.status||500})}}async function m(){return new n.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"PATCH, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"}})}[o,u]=p.then?(await p)():p,s()}catch(e){s(e)}})},517:(e,t,r)=>{r.d(t,{Nw:()=>o,ay:()=>a,uZ:()=>i});var s=r(4218);let n=new Map;async function a(e,t){let r=function(e){let t=e.headers.get("x-forwarded-for");return t?t.split(",")[0]?.trim()||"unknown":e.headers.get("x-real-ip")||e.ip||"unknown"}(e),a=`${t.keyPrefix}:${r}`,o=Date.now(),i=n.get(a);if(!i||i.expiresAt<o){n.set(a,{count:1,expiresAt:o+t.windowMs});return}if(i.count>=t.max)throw new s.qQ("Too many requests, please try again later.");i.count+=1,n.set(a,i)}let o={windowMs:9e5,max:100,keyPrefix:"general"},i={windowMs:9e5,max:200,keyPrefix:"admin"}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[680,38,883,684],()=>r(6947));module.exports=s})();